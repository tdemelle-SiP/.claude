# Creation Table Load Execution Audit

## Purpose
Complete trace of "Load Into Creation Table" action execution path with zero assumptions.

## Execution Trace

1. User selects "Load Into Creation Table" (dashboard-html.php:181)
2. Form contains template_action select element (dashboard-html.php:180)
3. Form has id "template-action-form" (dashboard-html.php:177)
4. JavaScript listens for form submit (template-actions.js:223)
5. Checks action equals "check_and_load_template_wip" (template-actions.js:223)
6. Gets templateTitle from selectedRows[0].title (template-actions.js:225)
7. Gets templateBasename from selectedRows[0].basename (template-actions.js:226)
8. Assigns templateBasename to templateName (template-actions.js:231)
9. Creates formData via createFormData() (template-actions.js:234)
10. Appends template_basename to formData (template-actions.js:235)
11. Calls handleAjaxAction() function (template-actions.js:238)
12. handleAjaxAction validates formData (ajax.js:67)
13. Gets action from formData (ajax.js:73)
14. Verifies action equals "sip_handle_ajax_request" (ajax.js:77)
15. Creates jQuery ajax request (ajax.js:89)
16. Sets url to sipCoreAjax.ajaxUrl (ajax.js:90)
17. Sets type to POST (ajax.js:91)
18. Sets processData to false (ajax.js:93)
19. Sets contentType to false (ajax.js:94)
20. Sets X-SiP-Plugin header (ajax.js:96)
21. Sends AJAX POST request (ajax.js:89)
22. PHP receives sip_handle_ajax_request action (ajax-handler.php:52)
23. Gets plugin from $_POST (ajax-handler.php:54)
24. Gets action_type from $_POST (ajax-handler.php:55)
25. Verifies nonce (ajax-handler.php:59)
26. Checks plugin in registered_plugins (ajax-handler.php:76)
27. Calls do_action sip_plugin_handle_action (ajax-handler.php:78)
28. sip_printify_route_action receives hook (printify-ajax-shell.php:25)
29. Checks plugin_id equals sip-printify-manager (printify-ajax-shell.php:27)
30. Switches on creation_setup_action (printify-ajax-shell.php:43)
31. Calls sip_handle_creation_setup_action (printify-ajax-shell.php:44)
32. Gets creation_setup_action from $_POST (creation-table-setup-functions.php:185)
33. Switches to check_and_load_template_wip case (creation-table-setup-functions.php:188)
34. Calls sip_ajax_check_and_load_template_wip (creation-table-setup-functions.php:189)
35. Calls sip_check_and_load_template_wip (creation-table-setup-functions.php:139)
36. Gets template_basename from $_POST (creation-table-setup-functions.php:20)
37. Gets WIP directory path (creation-table-setup-functions.php:29)
38. Globs for *_wip.json files (creation-table-setup-functions.php:30)
39. Checks if WIP files exist (creation-table-setup-functions.php:34)
40. Reads first WIP file content (creation-table-setup-functions.php:37)
41. Decodes JSON data (creation-table-setup-functions.php:38)
42. Stores existing_wip data (creation-table-setup-functions.php:41)
43. Checks if need_new_wip (creation-table-setup-functions.php:52)
44. Compares WIP filename with template (creation-table-setup-functions.php:59)
45. Unlinks old WIP if mismatch (creation-table-setup-functions.php:63)
46. Creates new WIP if needed (creation-table-setup-functions.php:68)
47. Calls sip_create_wip_file (creation-table-setup-functions.php:71)

## sip_create_wip_file Execution
47a. Validates template name provided (creation-table-setup-functions.php:273)
47b. Constructs template file path (creation-table-setup-functions.php:282)
47c. Checks template file exists (creation-table-setup-functions.php:284)
47d. Gets WIP directory path (creation-table-setup-functions.php:292)
47e. Copies template to WIP path (creation-table-setup-functions.php:294)
47f. Returns success with WIP path (creation-table-setup-functions.php:302)
48. Reads newly created WIP content (creation-table-setup-functions.php:75)
49. Decodes new WIP JSON (creation-table-setup-functions.php:76)
50. Updates referenced images (creation-table-setup-functions.php:101)
51. Returns result array (creation-table-setup-functions.php:107)
52. Checks result success (creation-table-setup-functions.php:141)
53. Prepares response_data array (creation-table-setup-functions.php:143)
54. Calls SiP_AJAX_Response::success (creation-table-setup-functions.php:149)
55. Creates response array (class-ajax-response.php:53)
56. Sets success to true (class-ajax-response.php:54)
57. Sets plugin to sip-printify-manager (class-ajax-response.php:55)
58. Sets action_type to template_action (class-ajax-response.php:56)
59. Sets action to check_and_load_template_wip (class-ajax-response.php:57)
60. Sets data array (class-ajax-response.php:59)
61. Calls wp_send_json (class-ajax-response.php:68)
62. Exits PHP execution (class-ajax-response.php:69)
63. AJAX success callback receives response (ajax.js:98)
64. Hides spinner if shown (ajax.js:101)
65. Calls handleSuccessResponse (ajax.js:109)
66. Validates response.success exists (ajax.js:163)
67. Gets routePlugin from response.plugin (ajax.js:174)
68. Gets routeActionType from response.action_type (ajax.js:175)
69. Creates handler key sip-printify-manager:template_action (ajax.js:185)
70. Checks for registered success handler (ajax.js:189)
71. Calls success handler if exists (ajax.js:191)
72. Resolves promise with response (ajax.js:112)
73. handleSuccessResponse receives response (template-actions.js:341)
74. Checks response.success is true (template-actions.js:345)
75. Switches on check_and_load_template_wip (template-actions.js:363)
76. Checks for creation_template_wip_data (template-actions.js:366)
77. Calls setCreationTemplateWipData (template-actions.js:374)
78. Triggers reloadCreationTable (template-actions.js:391)
79. Updates image table status (template-actions.js:396)
80. Updates product table highlights (template-actions.js:401)
81. Highlights selected template (template-actions.js:406)
82. Deselects all table rows (template-actions.js:414)

## setCreationTemplateWipData Execution
83. Sets window.creationTemplateWipData object (creation-table-setup-actions.js:1817)
84. Gets localStorage sip-core data (creation-table-setup-actions.js:1822)
85. Creates nested structure if needed (creation-table-setup-actions.js:1823-1824)
86. Stores template_title in loaded-wip (creation-table-setup-actions.js:1827)
87. Stores wipName in wipFilename (creation-table-setup-actions.js:1828)
88. Stores templateFile path (creation-table-setup-actions.js:1829)
89. Saves to localStorage (creation-table-setup-actions.js:1843)

## reloadCreationTable Execution
90. Checks window.creationTemplateWipData exists (creation-table-setup-actions.js:1944)
91. Hides no-template message (creation-table-setup-actions.js:1952)
92. Shows creation-datatable div (creation-table-setup-actions.js:1953)
93. Shows product-creation-container (creation-table-setup-actions.js:1956)
94. Checks if DataTable exists (creation-table-setup-actions.js:1960)
95. Destroys existing DataTable (creation-table-setup-actions.js:1966)
96. Calls initializeCreationDataTable (creation-table-setup-actions.js:1972)
97. Calls attachEventListeners (creation-table-setup-actions.js:1977)
98. Calls trackCreationTableUi (creation-table-setup-actions.js:1981)

## trackCreationTableUi Execution
98a. Gets sip-core from localStorage (utilities.js:618)
98b. Ensures sip-printify-manager object exists (utilities.js:619)
98c. Preserves existing creations-table properties (utilities.js:620)
98d. Captures creation_action dropdown value (utilities.js:621)
98e. Saves updated state to localStorage (utilities.js:622)

99. Returns true on success (creation-table-setup-actions.js:1984)

## updateImageTableStatus Execution
100. Gets image DataTable instance (image-actions.js:1563)
101. Clears existing highlighting classes (image-actions.js:1571)
102. Creates templateImageIds Set (image-actions.js:1575)
103. Creates childProductImageMap (image-actions.js:1576)
104. Collects template image IDs (image-actions.js:1599)
105. Updates table rows with highlighting (image-actions.js:continuing)
106. Rebuilds status filter dropdown (image-actions.js:continuing)

## updateProductTableHighlights Execution
107. Clears existing template classes (product-actions.js:1119)
108. Highlights blueprint rows (product-actions.js:continuing)
109. Highlights parent product rows (product-actions.js:continuing)
110. Highlights child product rows (product-actions.js:continuing)
111. Applies status-based CSS classes (product-actions.js:continuing)

## highlightSelectedTemplate Execution
112. Removes existing selected-template class (template-actions.js:322)
113. Checks templateFilename exists (template-actions.js:324)
114. Iterates through template table rows (template-actions.js:327)
115. Finds matching template title (template-actions.js:continuing)
116. Adds selected-template class (template-actions.js:continuing)

## deselectAllTemplateRows Execution
117. Calls deselectAllTemplateRows (template-actions.js:416)
118. Checks templateTable exists (template-actions.js:422)
119. Deselects all table rows (template-actions.js:423)

## Load Into Creation Table Complete